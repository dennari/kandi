
%% Käytä näitä, jos kirjoitat suomeksi
\documentclass[finnish,12pt,twoside]{article}
\usepackage{aaltothesis}
\usepackage[pdftex]{graphicx} 

%% Saat pdf-tiedoston viittaukset ja linkit kuntoon seuraavalla paketilla.
%% Paketti toimii erityisen hyvin pdflatexin kanssa. 
\usepackage[pdfpagemode=UseNone, colorlinks=true, urlcolor=black,
linkcolor=black, citecolor=black, pdfstartview=FitH]{hyperref}


%% Matematiikan fontteja, symboleja ja muotoiluja lisää, näitä tarvitaan usein 
\usepackage{amsmath,amsfonts,amssymb,amsbsy}  
%% Viitteet suomeksi
\usepackage{babelbib}

%% Vaakasuunnan mitat, ÄLÄ KOSKE!
\setlength{\hoffset}{-1in}
\setlength{\oddsidemargin}{35mm}
\setlength{\evensidemargin}{25mm}
\setlength{\textwidth}{15cm}
%% Pystysuunnan mitat, ÄLÄ KOSKE!
\setlength{\voffset}{-1in}
\setlength{\headsep}{7mm}
\setlength{\headheight}{1em}
\setlength{\topmargin}{25mm-\headheight-\headsep}
\setlength{\textheight}{23cm}


%%%%%%%% OMAT KOMENNOT %%%%%%%%%%%%

% infinitesimaalinen muutos
\newcommand{\ds}{\mathrm{d}}
\newcommand{\measure}[2]{\ds#1(#2)}
\newcommand{\dd}{\;\ds}
% määrätty integraali
\newcommand{\defint}[4]{
\int_{#1}^{#2}#3\dd#4
}

% reaaliluvut, kompleksiluvut..
\newcommand{\field}[1]{\mathbb{#1}}
\newcommand{\R}{\field{R}}
\newcommand{\C}{\field{C}}
\newcommand{\Deg}{\mathrm{Deg}}
\newcommand{\iprod}[2]{\langle{}#1,#2\rangle}
\renewcommand{\v}[1]{\mathbf{#1}} % vektorit ja matriisit


% kuvat
\newcommand{\scalefig}[3]{
  \begin{figure}[ht!]
    % Requires \usepackage{graphicx}
    \centering
    \includegraphics[width=#2\columnwidth]{#1}
    %%% I think \captionwidth (see above) can go away as long as
    %%% \centering is above
    %\captionwidth{#2\columnwidth}%
    \caption{#3}
    \label{#1}
  \end{figure}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%% Kaikki mikä paperille tulostuu, on tämän jälkeen
\begin{document}

%% Korjaa vastaamaan korkeakouluasia
\university{aalto university}{aalto-yliopisto}
\school{school of science and technology}{teknillinen korkeakoulu}

%% Korjaa seuraavat vastaamaan omaa tiedekuntaasi
\faculty{Faculty of Electronics, Communications and Automation}%
{Elektroniikan, tietoliikenteen ja automaation tiedekunta}%
%%

%% Vain kandityölle: Korjaa seuraavat vastaamaan tutkinto-ohjelmaasi 
\degreeprogram{Bioinformation technology}{Bioinformaatioteknologia}
%%

%% Vain DI/M.Sc.- ja lisensiaatintyölle
%\department{Department of Radio Science and Technology}{Radiotieteen ja -tekniikan laitos}
%\professorship{Circuit theory}{Piiriteoria}
%\code{S-55}
%%

%% Valitse yksi näistä kolmesta
\univdegree{BSc}
%\univdegree{MSc}
%\univdegree{Lic}

%% Oma nimi
\author{Ville Väänänen}

%% Opinnäytteen otsikko tulee vain tähän. Älä tavuta otsikkoa ja
%% vältä liian pitkää otsikkotekstiä. Jos latex ryhmittelee otsikon
%% huonosti, voit joutua pakottamaan rivinvaihdon \\ kontrollimerkillä.
%% Muista että otsikkoja ei tavuteta! 
%% Jos otsikossa on ja-sana, se ei jää rivin viimeiseksi sanaksi 
%% vaan aloittaa uuden rivin.
\thesistitle{Numerical integration: From quadratures to cubatures}{Numeerinen integrointi: kvadratuureista kubatuureihin}

\place{Espoo}
%% Kandidaatintyön päivämäärä on sen esityspäivämäärä! 
\date{10.5.2010}

%% Kandidaattiseminaarin vastuuopettaja TAI
%% Diplomityön valvoja
\supervisor{Prof. Markus Turunen}{Prof. Markus Turunen}

%% Kandidaatintyön ohjaaja(t) TAI
%% Diplomityön ohjaaja(t)
\instructor{D.Sc.(Tech.) Simo Särkkä}{TkT Simo Särkkä}
%% Aaltologo: syntaksi: \uselogo{red|blue|yellow}{?|!|''}
%% Logon kieli on sama kuin dokumentin kieli
\uselogo{red}{''}{tkk}

%% Tehdään kansilehti
\makecoverpage


%% Suomenkielinen tiivistelmä
%% 
%% Tiivistelmän avainsanat
%\keywords{kvadratuuri, kubatuuri, gaussinen kvadratuuri, numeerinen integrointi, polynomiapproksimaatio}
%% Tiivistelmän tekstiosa
%\begin{abstractpage}[finnish]
%  Tiivistelmässä on lyhyt selvitys (noin 100 sanaa)
%  kirjoituksen tärkeimmästä sisällöstä: mitä ja miten on tutkittu,
%  sekä mitä tuloksia on saatu. 
%  Tiivistelmässä on lyhyt selvitys (noin 100 sanaa)
%  kirjoituksen tärkeimmästä sisällöstä: mitä ja miten on tutkittu,
%  sekä mitä tuloksia on saatu.
%\end{abstractpage}

%% Pakotetaan uusi sivu varmuuden vuoksi, jotta 
%% mahdollinen suomenkielinen ja englanninkielinen tiivistelmä
%% eivät tule vahingossakaan samalle sivulle
%\newpage
%
%% English abstract, uncomment if you need one. 
%% 
%% Abstract keywords
%\keywords{Resistor, Resistance,\\ Temperature}
%% Abstract text
%\begin{abstractpage}[english]
% Your abstract in English 
%
%\end{abstractpage}
%% Note that 
%% if you are writting your master's thesis in English place the English
%% abstract first followed by the possible Finnish abstract

%% Esipuhe
\mysection{Esipuhe}

\vspace{5cm}
\dateandplace

\vspace{5mm}
{\hfill \author \hspace{1cm}}

%% Pakotetaan varmuuden vuoksi esipuheen jälkeinen osa
%% alkamaan uudelta sivulta
\newpage


%% Sisällysluettelo
%% addcontentsline tekee pdf-tiedostoon viitteen sisällysluetteloa varten
\addcontentsline{toc}{section}{Sisällysluettelo}
%% Tehdään sisällysluettelo
\tableofcontents


%% Symbolit ja lyhenteet
%%
%% Symbols and abbreviations
%\mysection{Symbolit ja lyhenteet}
%\subsection*{Symbolit}

%\begin{tabular}{ll}
%$\mathbf{B}$  & magneettivuon tiheys  \\
%$c$              & valon nopeus tyhjössä $\approx 3\times10^8$ [m/s]\\
%$\omega_{\mathrm{D}}$    & Debye-taajuus \\
%$\omega_{\mathrm{latt}}$ & hilan keskimääräinen fononitaajuus \\
%$\uparrow$       & elektronin spinin suunta ylöspäin\\
%$\downarrow$     & elektronin spinin suunta alaspäin
%\end{tabular}

%\subsection*{Operaattorit}

%\begin{tabular}{ll}
%$\nabla \times \mathbf{A}$              & vektorin $\mathbf{A}$ roottori\\
%$\displaystyle\frac{\mbox{d}}{\mbox{d} t}$ & derivaatta muuttujan $t$ suhteen\\
%[3mm]
%$\displaystyle\frac{\partial}{\partial t}$  & osittaisderivaatta muuttujan $t$ suhteen \\[3mm]
%$\sum_i $                       & Summa indeksin $i$ yli\\
%$\mathbf{A} \cdot \mathbf{B}$    & vektorien $\mathbf{A}$ ja $\mathbf{B}$ pistetulo
%\end{tabular}

%\subsection*{Lyhenteet}

%\begin{tabular}{ll}
%AC         & vaihtovirta \\
%APLAC      & an object-oriented analog circuit simulator and design tool \\
%           & (originally Analysis Program for Linear Active Circuits) \\
%BCS        & Bardeen-Cooper-Schrieffer \\ %% tavuviiva - nimien välissä 
%DC         & tasavirta \\
%TEM        & transverse eletromagnetic
%\end{tabular}


%% Sivulaskurin viilausta opinnäytteen vaatimusten mukaan:
%% Aloitetaan sivunumerointi arabialaisilla numeroilla (ja jätetään
%% leipätekstin ensimmäinen sivu tyhjäksi, 
%% ks. alla \thispagestyle{empty}).
%% Pakotetaan lisäksi ensimmäinen varsinainen tekstisivu alkamaan 
%% uudelta sivulta clearpage-komennolla. 
%% clearpage on melkein samanlainen kuin newpage, mutta 
%% flushaa myös LaTeX:n floatit 
\cleardoublepage
\storeinipagenumber
\pagenumbering{arabic}
\setcounter{page}{1}


%% Leipäteksti alkaa
\section{Johdanto}

%% Ensimmäisen sivun ylä- ja alatunnisteet tyhjiksi
\thispagestyle{empty}

Pinta-alojen ja tilavuuksien määrittäminen on yleisesti kohdattu ongelma matematiikan ja fysiikan sovelluksissa. 
Ei siis ole yllättävää, että jo kauan on tiedetty keinoja muuntaa pinta-aloja \emph{kvadratuureiksi}, 
samansuuruisiksi suorakulmioiksi. \emph{Integraali} on matemaattinen konstruktio, jolla on läheinen yhteys tähän ongelmaan· 
Tänä päivänä tekniikan alan ammattilaiset arkkitehdeistä tilastotieteilijöihin 
tarvitsevat työssään tarkkoja ja tehokkaita keinoja integraalien määrittämiseen, sillä niitä
joudutaan laskemaan esimerkiksi paljon käytetyssä elementtimenetelmässä sekä Bayes-mallinnuksen yhteydessä \cite{Zienkiewicz2005,Arasaratnam2009}. 

Joillekin yksinkertaisille \emph{integrandeille} $f(x)$ voidaan määrittää integraalifunktio
$F(x)$ ($F'(x)=f(x)$) suljetussa muodossa, niin että se on ilmaistu algebrallisina lauseina sekä tunnettujen 
transkendenttisten funktioiden avulla \cite{Stoer1993}. Tällaista integraalien määrittämistä kutsutaan myös symboliseksi
integroinniksi ja sitä opetetaan esimerkiksi lukiossa, minkä vuoksi integraalifunktion määrittämistä saatetaan
myös kutsua pelkästään integroinniksi.

Numeerinen integrointi on sovelletun matematiikan alalaji ja nimensä mukaisesti se tarjoaa työkaluja, joiden avulla integraaleille
voidaan määrittää numeerisia likiarvoja. Alalta on 
aikojen saatossa julkaistu suunnaton määrä tutkimustuloksia ja kirjallisuutta, joten minkä tahansa käytännössä 
esiintyvän integraalin ratkaisemiseen voisi olettaa löytyvän laskennallisesti tehokas ratkaisualgoritmi \cite{Ueberhuber1997}. 
Näin todennäköisesti onkin mikäli ongelmallinen integraali on määritelty ainoastaan yhdessä ulottuvuudessa, jolloin usein myös
on mahdollista saavuttaa miltein mikä tahansa haluttu tarkkuus. 
Jos kuitenkin dimensioita on enemmän kuin yksi, jolloin puhutuaan \emph{kubatuureista}, 
on ongelma, ehkä hieman yllättäen, kaikkea muuta kuin ratkaistu.

Numeerisen integroinnin menetelmät, joihin tässä työssä keskitytään, ovat muotoa
\begin{equation}
	I[f]:=\defint{\Omega}{}{f(\v{x})w(\v{x})}{\v{x}}\approx Q[f]:=\sum_{i=1}^Nw_if(\v{x}_i),
	\label{eq_cubature} 
\end{equation}
jossa $f$ on \emph{integrandi}, $\Omega\subset\R^n$ on integroimisalue (yhdessä ulottuvuudessa integroimisväli),
$w(\v{x})$ on \emph{painofunktio}, pisteet $\{\v{x}_i\}\in\R^n$ ovat \emph{solmut} tai \emph{tukipisteet} ja 
$\{w_i\}\in\R$ ovat \emph{painot}. Vuonna 1814 saksalainen matemaatikko Carl Friedrich Gauss julkaisi merkittävän
kaavan \eqref{eq_cubature} mukaisen tuloksensa (tapaukselle $n=1$ ja $w(x):=1$), joka tunnetaan hänen mukaansa 
nimellä \emph{Gaussin kvadratuuri} \cite{Gautschi1997}. Kyseessä on elegantti kvadratuuri, jossa hyödynnetään \emph{ortogonaalisia
polynomeja} ja saavutetaan suuri tarkkuus pienellä funktio-evaluaatioiden määrällä. Tästä vaikuttuneena kirjoitti aikalaisensa
Friedrich Bessel, myöskin tunnustettu matemaatikko, hänelle seuraavasti:
\begin{quote} 
``Nyt kun olen saanut haltuuni numeerista integrointia käsittelevän paperinne, en enää voinut pidättäytyä kiittämästä teitä siitä mielihyvästä, jonka olette minulle suoneet''\cite{Ueberhuber1997}
\end{quote}

Valitettavasti Gaussin tulos ei ole suoraan yleistettävissä useampaan ulottuvuuteen. Kuitenkin  
Vuonna 1877 James Clerk Maxwell esitteli 27-pisteisen, muotoa \ref{eq_cubature} olevan kubatuuri-säännön
ja tätä pidetään ensimmäisenä varsinaisena esimerkkinä kubatuurista sellaisena kuin se tänä päivänä ymmärretään \cite{Cools1997}.
Useampiulotteisten integraalien likimääräiseen ratkaisemiseen on täysin eri tyyppisiäkin menetelmiä,
joista tärkeimpänä mainittakoon erilaiset \emph{Monte Carlo} -menetelmät. Näissä integrandin arvo lasketaan 
suuressa määrässä satunnaisia pisteitä, jolloin integraalia voidaan approksimoida näiden arvojen
keskiarvona. Etuna on, että päästään tyystin eroon niin sanotusta \emph{dimensionaalisuuden kirouksesta},
jonka vuoksi useissa muissa integroimismenetelmissä tarvittavien funktio-evaluaatioiden määrä riippuu 
eksponentiaalisesti dimensioiden määrästä. Hyväksyttävään tarkkuuteen pääseminen vaatii suurta määrää satunnaispisteitä ja funktio-evaluaatioita
jo yhdessä dimensiossa. Kuitenkin dimensioiden määrän lähestyessä useita satoja, mikä on mahdollista esimerkikisi joissain finanssimatematiikan sovelluksissa, 
ovat Monte Carlo -menetelmät usein ainoa vaihtoehto. Jatkossa keskitytään ainoastaan kaavan \eqref{eq_cubature} mukaisiin sääntöihin.

Tässä työssä käydään ensin  läpi tarvittavat esitiedot, kuten Riemann integraali ja polynominen approksimaatio, 
jotta voidaan esittää Gaussin kvadratuurien idea. Tämän jälkeen keskitytään integrointiin useammassa kuin yhdessä
dimensiossa ja käydään läpi erilaisia keinoja kubatuuri-sääntöjen muodostamiseksi. Teoreettisen selvityksen jälkeen vertaillaan 
eräitä kiinnostavia menetelmiä keskenään soveltamalla niitä esimerkki-integraaleihin kahdessa dimensioissa. 
Saatujen tulosten ja esitellyn teorian perusteellä tehdään päätelmiä menetelmien soveltuvuudesta erilaisiin tilanteisiin.


%% Opinnäytteessä jokainen osa alkaa uudelta sivulta, joten \clearpage
\clearpage

\section{Riemann integraali}
Integraalille on olemassa useita kehittäjiensä mukaan nimettyjä määritelmiä, joista Riemann-integraali 
lienee yksinkertaisin ja intuitiivisin. Usein kun puhutaan integraalista tarkoitetaan nimenomaan 
Riemann-integraalia, mikä pätee myös tähän työhön. Riemann-integraali on määritelty kaikille suljetulla 
välillä $[a,b]$ melkein kaikkialla jatkuville ja rajoitetui reaaliarvoinen funktio on (Riemann-)integroituva ja integraalia merkitään $\defint{a}{b}{f(x)}{x}\in\R$, 
jota kutsutaan myös \emph{määrätyksi integraaliksi}. Määrätyllä integraalilla ja \emph{integraalifunktiolla} $F(x)$ 
(ja sitä kautta derivoinnilla) on läheinen yhteys, joka tunnetaan \emph{analyysin ensimmäisenä peruslauseena}:

\begin{equation}
	\label{fundamental_theorem}
	\defint{a}{b}{f(x)}{x}=\defint{a}{b}{F'(x)}{x}=F(b)-F(a)
\end{equation}
Huomionarvoista on se, että määrätyn integraalin \emph{olemassaolo} ei ole millään tavalla riippuvainen 
integraalifunktion $F(x)$ olemassaolosta.\cite{Cheney2007}

\subsection{Geometrinen tulkinta}

Geometrisesti tarkasteltuna luku $\defint{a}{b}{f(x)}{x}$ tarkoittaa kuvaajan $y=f(x)$, $x$-akselin ja 
suorien $x=a$ ja $x=b$ rajaamaa pinta-alaa. Tämä on suora seuraus Riemann-integraalin määritelmästä. 
Olkoon $P_n=\{a=x_{0}<x_{1}<\dots{}<x_{n-1}<x_{n}=b\}$ välin $[a,b]$ $n$-välinen jako, $m_{i}=\inf\{f(x)\;:\;x_{i}\leq{}x\leq{}x_{i+1}\}$ 
funktion $f(x)$ suurin alaraja ja $M_{i}=\sup\{f(x)\;:\;x_{i}\leq{}x\leq{}x_{i+1}\}$  vastaavasti pienin 
yläraja välillä $[x_{i},x_{i+1}]$. Jakoa $P_i$ kutsutaan $P_j$:n \emph{tihentymäksi} mikäli $P_i \subset P_j$ ja 
merkitään $\vert P_i \vert$ jaon $P_i$ pisintä jakoväliä.  
Tällöin Riemann-integraali voidaan määritellä \emph{ala}- \[L_{P_n}(f)=\sum_{i=0}^{n}m_{i}(x_{i+1}-x_{i})\] 
ja \emph{yläsummien} \[U_{P_n}(f)=\sum_{i=0}^{n}M_{i}(x_{i+1}-x_{i})\] avulla: 
jos pätee $\lim_{n\to\infty}\vert P_n \vert = 0$, niin
\begin{equation}		
		\liminf_{n\to\infty}U_{P_n}(f) = \limsup_{n\to\infty}L_{P_n}(f)=S \implies \defint{a}{b}{f(x)}{x} = S		
\end{equation}
Ala- ja yläsummia on havainnollistettu kuvassa \ref{fig_lusums} (jaon ei välttämättä tarvitse olla tasavälinen), josta on helppo nähdä, että jaon 
tihentyessä ala- ja ylässumat suppenevat samaan arvoon, joka vastaa kuvaajan $y=f(x)$ ja $x$-akselin 
rajaamaa pinta-alaa.\cite{Cheney2007}

\scalefig{fig_lusums}{0.8}{Ala- ja yläsummat $20$-välisellä jaolla}

\section{Numeerisia menetelmiä}

Käyttämällä tasavälistä jakoa, edellä esitellyistä ala- tai yläsummista saadaan suoraan eräs, melkoisen epätarkka, numeerinen 
integraaliapproksimaatio, \emph{suorakulmiomenetelmä} \cite{Ueberhuber1997}. Kuvan \ref{fig_lusums} esittämässä tapauksessa 
saadaan $L_{P_{20}}(e^{-x^2})\approx 1.57$ ja $U_{P_{20}}(e^{-x^2})\approx 1.96$, todellisen arvon 
ollessa $\defint{-2}{2}{e^{-x^2}}{x}\approx 1.76$. Tulosta voidaan hiukan parantaa valitsemalla suorakulmion $i$
korkeudeksi $f(\frac{x_i+x_{i+1}}{2})$.

Selkeä parannus saadaan aikaiseksi \emph{puolisuunnikasmenetelmällä}, jossa myös käytetään tasavälistä jakoa $P_n=\{x_i\;\vert\;x_i=a+hi\}$, mutta 
suorakulmiot on korvattu puolisuunnikkailla:

\begin{align} 
	\defint{x_{k}}{x_{k+1}}{f(x)}{x} \approx \frac{h}{2}\left(f(x_k)+f(x_{k+1})\right)	
	\label{eq_trapezoid}
\end{align}
Puolisuunnikasmenetelmää on havainnollistettu kuvassa \ref{fig_trapezoid}.\cite{Gautschi1997}
\scalefig{fig_trapezoid}{0.8}{Puolisuunnikasmenetelmä}

Sekä suorakulmiomenetelmä, että puolisuunnikasmenetelmä voidaan tulkita siten, että integrandia 
approksimoidaan jokaisella välillä vakiofunktiolla (0:nnen asteen polynomi) tai vastaavasti
ensimmäisen asteen polynomilla. Alkuperäinen integraali on siis $n$:n polynomintegraalin summa. 
Tällaisen tulkinnan siivittämänä näille menetelmille löytyy ilmeinen parannusehdotus: käytetään 
approksimointiin korkeamman asteen polynomia.\cite{Gautschi1997}

\subsection{Polynomiapproksimaatio}

Yleinen \emph{approksimaatio-ongelma} voidaan muotoilla seuraavasti: olkoon $f$ approksimoitava
funktio ja $\|\cdot\|$ normi, joka on määritelty halutunlaisia funktioita sisältävän vektorivaruuden $\Phi$
funktioille $\varphi$. Etsi $\hat{\varphi}\in\Phi$ siten että
\begin{equation}
	 \|f-\hat\varphi\|\leq\|f-\varphi\|\quad\forall\varphi\in\Phi .\cite{Gautschi1997}
\end{equation}

Jotta voitaisiin käsitellä sekä jatkuva että diskreetti tapaus samanaikaisesti, määritellään ensin jatkuva \emph{mitta} $\measure{\lambda}{t}$
seuravaasti:
\begin{equation} 
	\lambda(t)=
	\label{integrator}
	\begin{cases}
    	0 &  t < a \\
    	\defint{a}{t}{w(\tau)}{\tau} & a \leq t \leq b \\
    	\defint{a}{b}{w(\tau)}{\tau} &  t > b  
    \end{cases},
\end{equation}
jolloin $\measure{\lambda}{t} = w(t)\ds t$ jos $t\in[a,b]$ ja $\measure{\lambda}{t} = 0 $ jos $t\notin[a,b]$.
Nyt voidaan jatkuvalle funktiolle $u$ kirjoittaa
\begin{equation}
	\defint{-\infty}{\infty}{u(t)}{\lambda(t)} = \defint{\R}{}{u(t)}{\lambda(t)} = \defint{a}{b}{u(t)w(t)}{t}.
	\label{stieltjes-riemann} 
\end{equation} Kaavan \eqref{stieltjes-riemann} vasenta puolta kutsutaan yleisemmin \emph{Riemann-Stieltjes}-integraaliksi ja kaava
\eqref{stieltjes-riemann} siis kertoo sen yhteyden Riemann-integraaliin mikäli $\lambda(t)$ (jota ei ole pakko määritellä kuten kaavassa \eqref{integrator}) on kaikkialla jatkuvasti derivoituva. Funktiota $w(t)$ kutsutaan \emph{painofunktioksi} (voi olla $w(t)\equiv 1$) ja sen tulee olla määritelty siten, että $\lambda(t)$ on määritelty.
Tämä tarkoittaa myös, että väli $[a,b]$, eli $\ds\lambda$:n \emph{kantaja}, voi olla ääretön, jos $w$:n integraali on määritelty tällä välillä. Jotta $\ds\lambda$ olisi mitta, vaaditaan myös että $w(t)\geq 0$ ja yhtäsuuruus sallitaan vain yksittäisissä pisteissä.
 
Diskreetti mitta saa nollasta poikkeavia arvoja $w_i$ vain $N$:ssä pisteessä $t_i$, jolloin voidaan kirjoittaa vastaavasti
$\defint{\R}{}{u(t)}{\lambda(t)} = \sum_{i=1}^{N}w_iu(t_i)$. 

Riemann-integroituville funktioille voidaan määritellä sisätulo $\iprod{\cdot}{\cdot}:\Phi\times\Phi\to\R$ 
jatkuvassa tapauksessa alueessa $[a,b]$ painofunktion $w$ suhteen
\begin{equation}
	\iprod{f}{g}_w=\defint{a}{b}{f(x)g(x)w(x)}{x}
\end{equation}
ja diskreettinä pisteissä ${x_i:i=1,\dots,N}$ painokertoimien ${w_i:i=1,\dots,N}$ suhteen 
\begin{equation}
	\iprod{f}{g}_w=\sum_{a}^{b}f(x_i)g(x_i)w_i.
\end{equation}
Tällöin sisätulon indusoima normi on
\begin{equation}
	\|f\|=\sqrt{\iprod{f}{f}}. 
\end{equation}
Jos approksimaatioalue on diskreetti ja parhaalle approksimaatiolle $\hat\varphi$ pätee $\|f-\hat\varphi\|$,
niin silloin $\hat\varphi(t_i)=f(t_i)\quad\forall i = 1,\dots,N$ ja sanotaan että $\hat\varphi$ \emph{interpoloi} funktiota $f$
pisteissä $t_i$.\cite{Gautschi1997} 

Polynomit ovat yleisimmin käytettyjä approksimointifunktioita ja ylivoimaisesti suurin osa numeerisista integroimismenetelmistä
perustuu integrandin approksimointiin polynomilla \cite{Davis1975}. Tämä johtuu muun muassa siitä, että polynomien 
käyttäytyminen tunnetaan hyvin perinpohjaisesti sekä \emph{Weierstrassin teoreemasta}, jonka mukaan mitä tahansa jatkuvaa
funktiota voidaan approksimoida äärellisellä välillä mielivaltaisen tarkasti tarpeeksi korkea-asteisella 
polynomilla \cite{Davis1975}\cite{Gautschi1997}.  

Polynomisessa interpolaatiossa $\Phi=\mathbb{P}_m$, eli vektoriavaruus, johon kuuluvat kaikki polynomit joiden asteluku $\Deg(p)\leq m$.
Halutaan siis löytää sellainen polynomi $p$, jolle pätee $p(x_i) = f(x_i)\quad\forall i$, kun $\{x_i\}$ on $n+1$ 
erillistä pistettä ja $\{f(x_i)\}\in\R$ niitä vastaavat mielivaltaiset arvot. Osoittautuu että, $p$ on aina olemassa, 
se on ainutkertainen ja $m\leq n$.\cite{Cheney2007}

Interpoloiva polynomi $p$ voidaan konstruoida \emph{Lagrange} muodossaan Lagrangen \emph{kantapolynomien} $\ell_i$ avulla:
\begin{align*}
	&\ell_i(x)=\prod_{\substack{j\neq i\\j=0}}^{n}\left(\frac{x-x_j}{x_i-x_j}\right)\\
	\implies & \ell_i(x_j)=\delta_{ij}=
	\begin{cases}
    	0 & i \neq j \\
    	1 & i = j
    \end{cases}.
\end{align*}
Nyt jos $p$ määritellään $\ell_i$:n lineaarikombinaationa 
\[
	p(x)=\sum_{i=0}^{n}\ell_i(x)y_i,
\]
niin selvästi pätee 
\[
	p(x_i)=\ell_i(x_i)y_i=y_i.
\]
ja koska $\text{Deg}(\ell_i)=n$, niin myös $\text{Deg}(p)=n$.

\subsection{Newton-Cotes menetelmät}

Aiemmin esitellyssä puolisuunnikasmenetelmässä 
integrointiväli oli jaettu osaväleihin ja integrandia approksimoitiin 
ensimmäisen asteen polynomilla jokaisella osavälillä. 
Menetelmää, jossa samaa sääntöä käytetään toistuvasti usealla 
osavälillä, kutsutaan \emph{yhdistelmämenetelmäksi} (eng. \emph{compound} tai \emph{composite}) 
\cite{Davis1975}. Jos integointiväli on jaettu osaväleihin, seuraavassa 
tarkastelussa keskitytään ainoastaan yhteen osaväliin (joka sisältää $n+1$ pistettä).
 
Jos nyt tasavälisellä jaolla $\{a=x_0,x_1=a+h,\dots,x_{n-1}=a+(n-1)h,x_n=a+nh=b\}$ käytetään $f$:n 
tilalla edellä määriteltyä interpoloivaa polynomia $p$, saadaan
\begin{align} 
	\defint{a}{b}{f(x)}{x} = \defint{a}{b}{p(x)}{x} 
	=&\defint{a}{b}{\sum_{i=0}^{n}\ell_{i}(x)f(x_{i})}{x}+E_n(p) \nonumber \\ 
	=&\sum_{i=0}^{n}\left(f(x_{i})\defint{a}{b}{\ell_{i}(x)}{x}\right)+E_n(p) \nonumber \\  
	=&\sum_{i=0}^{n}f(x_{k+i})w_i+E_n(p) \label{eq_newton_cotes} \\
	w_i=&\defint{a}{b}{\prod_{\substack{j\neq i\\j=0}}^{n}\left(\frac{x-x_j}{x_i-x_j}\right)}{x}. \label{eq_weights}  
\end{align}
Tällä tavalla muodostetut menetelmät tunnetaan nimellä \emph{Newton-Cotes} menetelmät ja ne poikkeavat toisistaan interpolaatiopisteiden
lukumäärässä. Jos välin päätepisteet kuuluvat interpolaatiopisteiden joukkoon, menetelmää kutsutaan suljetuksi 
ja jos eivät, niin avoimeksi. Kaavassa \ref{eq_newton_cotes} pisteitä $x_i$ kutsutaan \emph{solmuiksi} tai \emph{tukipisteiksi}
ja kertoimia $w_i$ \emph{painoiksi}.\cite{Gautschi1997}

Havaitaan, että mikäli kaavassa \ref{eq_newton_cotes} valitaan $n=1$, ja sovelletaan sitä toistuvasti usealla osavälillä,
saadaan edellä esitelty puolisuunnikasmenetelmä (\ref{eq_trapezoid}).
Jos taas valitaan $n=2$, eli interpolaatioon käytetään kolmea pistettä, saadaan laajalti käytetty 
\emph{Simpsonin} menetelmä: \cite{Gautschi1997}
\begin{align*} 
	&\defint{x_{k}}{x_{k+2}}{f(x)}{x} \approx \frac{h}{3}\left(f(x_k)+4f(x_{k+1})+f(x_{k+2})\right) \\
	\implies & \defint{a}{b}{f(x)}{x} \approx \frac{h}{3}\left(f(a)+4f(x_{1})+2f(x_{2})+4f(x_{3})+2f(x_{4})+\dots+4f(x_{n-1})+f(b)\right)
\end{align*}

Virheen $E_n(p)$ pienentämiseksi voidaan nähdä kaksi eri lähestymistapaa: joko käytetään pienen tarkkuusasteen Newton-Cotes kaavaa aina vain lyhyemmillä osaväleillä tai käytetään pidempiä osavälejä mutta suurta tarkkuusastetta. Ensimmäisessä tapauksessa evaluointipisteiden määrä kasvaa nopeasti epäkäytännöllisen suureksi. Kuitenkin sekä puolisuunnikasmenetelmä että Simpsonin menetelmä ovat erittäin laajalti käytettyjä ja voidaan näyttää, että kun osavälien määrä $N\to\infty$ niin $E_n(p)\to\infty$ kaikille integrointivälillä jatkuville funktioille. Toisessa tapauksessa $n:än$ kasvaessa suureksi, voivat painot $w_i$ olla joko positiivisia tai negatiivisiä ja absoluuttiselta arvoltaan milivaltaisen suuria, jolloin nämä menetelmät eivät enää ole numeerisessa mielessä stabiileja. Tämän vuoksi korkean tarkkuusasteen Newton-Cotes
menetelmiä ei juurikaan käytetä.\cite{Krylov1962}

Sanotaan että muotoa \ref{eq_newton_cotes} olevan kvadratuurin \emph{tarkkuusaste} on $d$, jos se antaa tarkan tuloksen kaikille polynomeille, jotka ovat 
korkeintaan astetta $d$, eli $E_n(p)=0$, jos $\Deg(p)\leq d$, mutta ei yhdellekään polynomille jonka $\Deg(p)> d$. Koska Newton-Cotes menetelmissä integrandia interpoloidaan $n+1$:ssä pisteessä astetta $n$ olevalla polynomilla, niin $d_{NC}=n-1$ ja Newton-Cotes kaavoja kutsutaan \emph{interpolatorisiksi}.
Tästä seuraa luonnollisesti kysymys, onko tarkkuuastetta mahdollista parantaa interpolatorista paremmaksi? Mikäli solmupisteet $x_i$ ovat ennalta määrätyt, on interpolatorinen tarkkuusaste paras mahdollinen, mutta jos solmupisteet voidaan valita vapaasti, voidaan tarkkuusatetta parantaa.

\subsection{Gaussin kvadratuuri}

Jatkossa keskitytään muotoa
\begin{equation}
	\defint{a}{b}{f(x)w(x)}{x}=\sum_{i=1}^nf(x_i)w_i+E_n(f)
	\label{eq_weighted_quadrature}
\end{equation}
oleviin kvadratuureihin, missä $w$ on ei-negatiivinen painofunktio. 
Väli $(a,b)$ voi olla ääretön, mikäli painofunktion kaikki
momentit $\mu_s$

\begin{equation}
	\mu_s=\defint{a}{b}{t^s}{w(t)},\forall s\in\field{N} 
\end{equation}
ovat määritellyt. Newton-Cotes kaavojen perusteella tiedetään, että mikäli on 
annetut mitkä tahansa $n$ pistettä, niin voidaan
määrittää kaava \ref{eq_weighted_quadrature}, jonka tarkkuusaste on $d=n-1$. Voidaan kuitenkin
osoittaa, että muotoa \ref{eq_weighted_quadrature} olevan kvadratuurin maksimaalinen tarkkuusaste
on $d=2n-1$, mikäli jokainen $n$:stä solmusta saadaan valita vapaasti.

Kuinka solmut ${x_i}$ tulisi sitten valita? Tämän osoittamiseksi määritellään ensin \emph{solmupolynomi}
\begin{equation}
	\omega_n(x)=\prod_{i=1}^n(x-x_i).
	\label{eq_knot_polynomial} 
\end{equation}
Nyt jos ja vain jos solmupolynomille pätee
\begin{equation}
	\defint{a}{b}{\omega_n(x)p_{n-1}(x)w(x)}{x}=0\:,\quad\forall p_{n-1}\in\field{P}_{n-1}
	\label{eq_orthogonal_polynomials} 
\end{equation}
niin kaavan \ref{eq_weighted_quadrature} mukaisen kvadratuurin tarkkuusaste
on $d=2n-1$. Tämän todistamiseksi osoitetaan ensin ehdon \ref{eq_orthogonal_polynomials} 
välttämättömyys, eli oletetaan että $d=2n-1$. 
Selvästi $\omega_np_{n-1}\in\field{P}_{2n-1}\quad\forall p\in\field{P}_{n-1}$ ,
jolloin
\begin{equation}
	 \defint{a}{b}{\omega_n(x)p_{n-1}(x)w(x)}{x}=\sum_{i=1}^np_{n-1}(x_i)w_i=0.
\end{equation} 
Toisaalta jos otetaan mikä tahansa $p\in\field{P}_{2n-1}$ ja oletetaan ehto \ref{eq_orthogonal_polynomials}, 
niin tällöin
$p/\omega_n=q+r/\omega_n$ niin että $q,r\in\field{P}_{n-1}$ ja
\begin{equation}
	\defint{a}{b}{p(x)w(x)}{x}=\defint{a}{b}{q(x)\omega_n(x)w(x)}{x}+\defint{a}{b}{r(x)w(x)}{x}. 
\end{equation}
Koska $q\in\field{P}_{n-1}$ niin ehdon \ref{eq_orthogonal_polynomials} nojalla
\begin{equation}
	 \defint{a}{b}{q(x)\omega_n(x)w(x)}{x}=0,
\end{equation}
kun taas 
\begin{align*}
	 &\defint{a}{b}{r(x)w(x)}{x}=\sum_{i=1}^{n}w_ir(x_i)\\
	 =&\sum_{i=1}^{n}w_i\left(p(x_i)-q(x_i)\omega_n(x_i)\right)=\sum_{i=1}^{n}w_ip(x_i),
\end{align*}
joten
\begin{align*}
	 &\defint{a}{b}{p(x)w(x)}{x}=\sum_{i=1}^{n}w_ip(x_i)\\
	 \implies&E_n(p)=0.
\end{align*}
Eli sääntö on tarkka polynomeille, jotka ovat korkeintaan astetta $d=2n-1$. Toisaalta jos tarkastellaan
esimerkiksi polynomia $\omega_n^2(x)\in\field{P}_{2n}$ niin selvästi
niin \[ \defint{a}{b}{\omega_n^2(x)w(x)}{x} > 0, \] mutta \[ \sum_{i=0}^nw_i\omega_n^2(x_i)=0, \] 
joten sääntö ei ole tarkka polynomeille astetta $2n$ \cite{Krylov1962}.

Keskitytään nyt tarkastelemaan ehtoa \ref{eq_orthogonal_polynomials}. Sanotaan että $f$ ja $g$ ovat 
\emph{ortogonaaliset} $w$:n suhteen, jos
\begin{equation}
	\iprod{f}{g}_w=0. 
\end{equation} Kaavasta \ref{eq_knot_polynomial} havaitaan, että mikäli solmupolynomin määritelmä tunnettaisiin, saataisiin
solmut $x_i$ laskettua sen nollakohdista. Sisätulon ja ortogonaalisuuden määritelmien perusteella ehto \ref{eq_orthogonal_polynomials}
tarkoittaa solmupolynomin olevan sellainen polynomi $\omega_n\in\field{P}_n$, joka on ortogonaalinen $w$:n suhteen 
kaikkia polynomeja $p_{n-1}\in\field{P}_{n-1}$ kohtaan. Koska sisätulo on lineaarinen operaattori ja jos 
$\{e_0,\dots,e_{n-1}\}$ on jokin $\field{P}_{n-1}$ \emph{kanta}, riittää että $\omega_n$ on ortogonaalinen
kaikkia kantapolynomeja $e_i$ kohtaan. Yleisesti käytettyjä kantapolynomeja ovat \emph{monomit} $x^i$, joiden avulla
eräs $\field{P}_{n-1}$:n kanta on  $\{1,x,\dots,x^{n-1}\}$.

Näiden tietojen perusteella voimme esimerkinomaisesti laskea kolmipisteisen Gaussin kvadratuurin 
vakiopainofunktiolle $w(x)=1$ ja välille $[-1,1]$:
\begin{align*}
	\defint{-1}{1}{f(x)}{x}\approx &w_0f(x_0)+w_1f(x_1)+w_2f(x_2)\\
	\omega_3=&(x-x_0)(x-x_1)(x-x_2)=x^3+a_2x^2+a_1x+a_0. 
\end{align*}  
Nyt siis $\omega_3$:n täytyy olla ortogonaalinen monomeja ${1,x,x^2}$ vastaan, joten saadaan yhtälöryhmä
\begin{equation*} 
	\begin{cases}
		0=&\defint{-1}{1}{x^3+a_2x^2+a_1x+a_0}{x}\\
		0=&\defint{-1}{1}{x(x^3+a_2x^2+a_1x+a_0)}{x}\\
		0=&\defint{-1}{1}{x^2(x^3+a_2x^2+a_1x+a_0)}{x} 
	\end{cases},
\end{equation*}
jonka ratkaisu on $a_0=a_2=0$ ja $a_1=-\frac{3}{5}$, jolloin $x_0=-\sqrt{\frac{3}{5}},x_1=0,x_2=\sqrt{\frac{3}{5}}$.
Painot $w_i$ voitaisiin laskea kaavasta \ref{eq_weights}, mutta ne saadaan helpommin käyttämällä hyväksi tietoa, että 
etsimämme kvadratuuri on tarkka mm. monomeille ${1,x,x^2}$. Näin saadaan toinen yhtälöryhmä painoille $w_i$:
\begin{equation*} 
	\begin{cases}
		\defint{-1}{1}{}{x}=2&=w_0+w_1+w_2\\
		\defint{-1}{1}{x}{x}=0&=-\sqrt{\frac{3}{5}}w_0+\sqrt{\frac{3}{5}}w_2\\
		\defint{-1}{1}{x^2}{x}=\frac{2}{3}&=\frac{3}{5}w_0+\frac{3}{5}w_2 
	\end{cases},
\end{equation*}
jonka ratkaisu on $w_0=w_2=\frac{5}{9}$ ja $w_1=\frac{8}{9}$. Etsimämme kvadratuuri on siis
\begin{equation*}
	 \defint{-1}{1}{f(x)}{x}\approx G_3(f(x))=\frac{5}{9}f\left(-\sqrt{\frac{3}{5}}\right)+\frac{8}{9}f(0)+\frac{5}{9}f\left(\sqrt{\frac{3}{5}}\right)\\
\end{equation*}.
Transformaation $t=x+1$ avulla voidaan edellä laskettua kvadratuuria käyttää välillä $[0,2]$, jolloin soveltamalla 
sitä jo aiemmin tutkimaamme esimerkki-integrandiin $f(x)=e^{-x^2}$ ja hyödyntällä integrandin symmetrisyyttä $y$-akselin suhteen, 
saadaan tulokseksi
\begin{align*}
	 \defint{-2}{2}{e^{-x^2}}{x}=2\defint{0}{2}{e^{-x^2}}{x}\approx 2G_3(e^{-(x+1)^2})\approx& 1.7577\\
	 2E_{G_3}(e^{-(x+1)^2})\approx& 0.0064.
\end{align*}
Vastaavasti käyttämällä Simpsonin menetelmää samassa tilanteessa saadaan virheeksi
\begin{align*}
	 2E_S(e^{-x^2})\approx& 0.1043,
\end{align*}
joka on yli $16$ kertaa suurempi kuin Gaussin kvadratuurin virhe.

\subsubsection{Ortogonaalisista polynomeista}

Ortogonaalisia polynomeja on tutkittu paljon ja tätä tietoutta voidaan käyttää
hyväksi solmupolynomin $\omega_n$ muodostamisessa ja sitä kautta solmujen $x_i$ laskennassa. 
<Esittele tunnetuimmat ortogonaalisten polynomien luokat>


\section{Kubatuurit}
\subsection{Tulosäännöt}
\subsection{Integroimisalueet}
\subsection{Kubatuurisääntöjä}
\subsubsection{Gauss-Hermite}
\section{Koeasetelma}

\section{Tulokset}

\section{Yhteenveto}
\clearpage{}

\addcontentsline{toc}{section}{Viitteet}
\bibliographystyle{abbrv}
\bibliography{kandi}


\end{document}



